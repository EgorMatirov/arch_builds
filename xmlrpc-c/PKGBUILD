# Maintainer: Filippov Aleksey <sarum9in@gmail.com>
pkgname=xmlrpc-c-svn
pkgver=0.0.0
pkgrel=1
pkgdesc="This library provides a modular implementation of XML-RPC for C and C++"
arch=('i686' 'x86_64')
url="http://xmlrpc-c.sourceforge.net/"
license=('custom:xmlrpc-c')
groups=()
depends=('curl' 'libxml2' 'gcc-libs' 'zlib')
makedepends=('libtool' 'subversion')
provides=('xmlrpc-c')
conflicts=('xmlrpc-c')
replaces=('xmlrpc-c')
backup=()
options=('!makeflags' '!libtool')
install=
source=("$pkgname::svn+http://xmlrpc-c.svn.sourceforge.net/svnroot/xmlrpc-c/advanced")
noextract=()
md5sums=('SKIP')

pkgver() {
  cd "$SRCDEST/$pkgname"
  svnversion | tr -d [A-z]
}

build() {
  cd "$srcdir/$pkgname"
  #./autogen.sh
  #patch -Np0 -i "${srcdir}/callInfo.patch"
  ./configure \
        --prefix=/usr \
        --disable-wininet-client \
        --enable-curl-client \
        --disable-libwww-client \
        --enable-tools \
        --enable-abyss-server \
        --enable-cgi-server \
        --enable-cplusplus \
        --enable-abyss-threads \
        --enable-libxml2-backend
  make CFLAGS_PERSONAL="${CFLAGS}" || return 1
}

package() {
  cd "$srcdir/$pkgname"
  make DESTDIR="$pkgdir/" install
  cp "$srcdir/$pkgname/include/xmlrpc-c/"* "$pkgdir/usr/include/xmlrpc-c/"
  mkdir -p "$pkgdir/usr/share"
  #mv "$pkgdir/man" "$pkgdir/usr/share/man"
}
